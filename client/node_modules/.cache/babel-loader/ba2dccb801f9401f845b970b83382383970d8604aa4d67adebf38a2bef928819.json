{"ast":null,"code":"import _taggedTemplateLiteral from\"C:/Users/user/Documents/GitHub/neighborhood_restaurant/client/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2,_templateObject3,_templateObject4;import Overlay from\"./Overlay\";import React,{useState}from'react';import axios from\"axios\";import{motion}from\"framer-motion\";import{useForm}from\"react-hook-form\";import styled from\"styled-components\";import{useNavigate}from\"react-router-dom\";import{useRecoilState,useSetRecoilState}from\"recoil\";import{loginState,name,session}from\"../atom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const LoginContainer=styled(motion.div)(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n    position: absolute;\\n    z-index: 5;\\n    top: 300px;\\n    text-align: center;\\n    background-color: whitesmoke;\\n    width: 400px;\\n    height: 200px;\\n    background-color: rgba(255, 255, 255, 1);\\n    border-radius: 40px;\\n    position: absolute;\\n    top: 200px;\\n    left: 0px;\\n    right: 0px;\\n    margin: 0 auto;\\n    box-shadow: 0 2px 3px rgba(0, 0, 0, 0.1), 0 10px 20px rgba(0, 0, 0, 0.06);\\n    @media screen and (max-width: 700px) {\\n        width: 250px;\\n    }\\n\"])));const LoginList=styled.li(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n    margin: 5px;\\n\"])));const LoginInput=styled.input(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n    width: 100%;\\n    height: 30px;\\n    border-radius: 5px;\\n    border-width: 1px;\\n\"])));const LoginBtn=styled.button(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n    margin: 0 auto;\\n    margin-top: 15px;\\n    width: 100px;\\n    height: 30px;\\n    border-width: 0px;\\n    text-align: center;\\n    border-radius: 5px;\\n\"])));const boxVariants={initial:{opacity:0,scale:0},visible:{opacity:1,scale:1},leaving:{opacity:0,scale:0}};// interface FormData {\n//     id: string;\n//     password: string;\n// }\nexport default function Login(){const{register,handleSubmit,formState:{errors}}=useForm();const[sessionExpiration,setSessionExpiration]=useState(null);const[sessionID,setSessionID]=useRecoilState(session);const[userId,setUserId]=useRecoilState(name);const[isLocationSaved,setIsLocationSaved]=useState(false);const setLogin=useSetRecoilState(loginState);const navigate=useNavigate();const saveLocation=async sessionID=>{try{navigator.geolocation.getCurrentPosition(async position=>{const{latitude,longitude}=position.coords;await axios.post('/location',{sessionID,x:longitude,y:latitude});// 세션 ID로 위치 저장 요청 보내기\nsetIsLocationSaved(true);// 위치 저장됨을 표시\n// alert('위치가 성공적으로 저장되었습니다.');\n});}catch(error){console.error('위치 저장 중 오류가 발생했습니다:',error);// alert('위치를 저장하는 도중 오류가 발생했습니다.');\n}};const LoginSuccess=async data=>{try{const response=await axios.post('/login',data);// console.log('로그인 응답 데이터:', response.data); // 로그인 응답 데이터 확인\nconst{sessionID,userId}=response.data;// 세션 ID 및 사용자 이름 받아오기\nif(response.data.message==='로그인 성공'&&sessionID){setSessionID(sessionID);// 세션 ID 설정\nsetUserId(userId);// 사용자 아이디 설정\nsessionStorage.setItem('sessionID',sessionID);// 세션 스토리지에 세션 ID 저장\nsessionStorage.setItem('userId',userId);// 세션 스토리지에 사용자 아이디 저장\n// 위치 저장 요청 보내기\n// saveLocation(sessionID); // 세션 ID를 인자로 사용하여 위치 저장 요청 보내기\nalert(\"로그인에 성공했습니다.\");setLogin(false);}else{console.error('로그인 실패:',response.data.message);}}catch(error){console.error('로그인 중 오류가 발생했습니다:',error);}};const handleLogout=async()=>{try{await axios.get('/logout');// 서버로 로그아웃 요청 보냄\nsessionStorage.removeItem('sessionID');// 세션 스토리지에서 세션 ID 제거\nsetSessionID('');// 세션 ID 초기화\nsetUserId('');navigate('/');// 홈 페이지로 이동\n}catch(error){console.error('로그아웃 중 오류가 발생했습니다:',error);}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(LoginContainer,{className:\"card\",variants:boxVariants,initial:\"initial\",animate:\"visible\",exit:\"leaving\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(LoginSuccess),children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:\"\\uB85C\\uADF8\\uC778\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"list-group list-group-flush\",children:[/*#__PURE__*/_jsx(LoginList,{className:\"list-group-item\",children:/*#__PURE__*/_jsx(LoginInput,{...register(\"id\"),placeholder:\"\\uC544\\uC774\\uB514\\uB97C \\uC785\\uB825\\uD558\\uC138\\uC694\"})}),/*#__PURE__*/_jsx(LoginList,{className:\"list-group-item\",children:/*#__PURE__*/_jsx(LoginInput,{...register(\"password\"),placeholder:\"\\uBE44\\uBC00\\uBC88\\uD638\\uB97C \\uC785\\uB825\\uD558\\uC138\\uC694\"})}),/*#__PURE__*/_jsx(LoginBtn,{type:\"submit\",children:\"\\uB85C\\uADF8\\uC778\"})]})]})}),/*#__PURE__*/_jsx(Overlay,{})]});}","map":{"version":3,"names":["Overlay","React","useState","axios","motion","useForm","styled","useNavigate","useRecoilState","useSetRecoilState","loginState","name","session","jsx","_jsx","jsxs","_jsxs","LoginContainer","div","_templateObject","_taggedTemplateLiteral","LoginList","li","_templateObject2","LoginInput","input","_templateObject3","LoginBtn","button","_templateObject4","boxVariants","initial","opacity","scale","visible","leaving","Login","register","handleSubmit","formState","errors","sessionExpiration","setSessionExpiration","sessionID","setSessionID","userId","setUserId","isLocationSaved","setIsLocationSaved","setLogin","navigate","saveLocation","navigator","geolocation","getCurrentPosition","position","latitude","longitude","coords","post","x","y","error","console","LoginSuccess","data","response","message","sessionStorage","setItem","alert","handleLogout","get","removeItem","children","className","variants","animate","exit","onSubmit","placeholder","type"],"sources":["C:/Users/user/Documents/GitHub/neighborhood_restaurant/client/src/components/Login.tsx"],"sourcesContent":["import Overlay from \"./Overlay\";\r\nimport React, { FormEvent, useEffect, useState } from 'react';\r\nimport axios from \"axios\"\r\nimport { AnimatePresence, motion } from \"framer-motion\"\r\nimport { useForm } from \"react-hook-form\"\r\nimport styled from \"styled-components\"\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { useRecoilState, useSetRecoilState } from \"recoil\";\r\nimport { loginState, name, session } from \"../atom\";\r\n\r\nconst LoginContainer = styled(motion.div)`\r\n    position: absolute;\r\n    z-index: 5;\r\n    top: 300px;\r\n    text-align: center;\r\n    background-color: whitesmoke;\r\n    width: 400px;\r\n    height: 200px;\r\n    background-color: rgba(255, 255, 255, 1);\r\n    border-radius: 40px;\r\n    position: absolute;\r\n    top: 200px;\r\n    left: 0px;\r\n    right: 0px;\r\n    margin: 0 auto;\r\n    box-shadow: 0 2px 3px rgba(0, 0, 0, 0.1), 0 10px 20px rgba(0, 0, 0, 0.06);\r\n    @media screen and (max-width: 700px) {\r\n        width: 250px;\r\n    }\r\n`\r\n\r\nconst LoginList = styled.li`\r\n    margin: 5px;\r\n`\r\n\r\nconst LoginInput = styled.input`\r\n    width: 100%;\r\n    height: 30px;\r\n    border-radius: 5px;\r\n    border-width: 1px;\r\n`\r\n\r\nconst LoginBtn = styled.button`\r\n    margin: 0 auto;\r\n    margin-top: 15px;\r\n    width: 100px;\r\n    height: 30px;\r\n    border-width: 0px;\r\n    text-align: center;\r\n    border-radius: 5px;\r\n`\r\nconst boxVariants = {\r\n    initial: {\r\n        opacity: 0,\r\n        scale: 0\r\n    },\r\n    visible: {\r\n        opacity: 1,\r\n        scale: 1\r\n    },\r\n    leaving: {\r\n        opacity: 0,\r\n        scale: 0\r\n    }\r\n}\r\n\r\ninterface LoginForm {\r\n    id: string,\r\n    password: string,\r\n    // nickName: string,\r\n    // location: {\r\n    //     x: Number,\r\n    //     y: Number\r\n    // }\r\n}\r\n\r\n// interface FormData {\r\n//     id: string;\r\n//     password: string;\r\n// }\r\nexport default function Login() {\r\n    const { register, handleSubmit, formState: { errors } } = useForm<LoginForm>();\r\n    const [sessionExpiration, setSessionExpiration] = useState<Date | null>(null);\r\n    const [sessionID, setSessionID] = useRecoilState(session);\r\n    const [userId, setUserId] = useRecoilState(name);\r\n    const [isLocationSaved, setIsLocationSaved] = useState<boolean>(false);\r\n    const setLogin = useSetRecoilState(loginState);\r\n    const navigate = useNavigate();\r\n    const saveLocation = async (sessionID: string) => {\r\n        try {\r\n            navigator.geolocation.getCurrentPosition(async (position) => {\r\n                const { latitude, longitude } = position.coords;\r\n                await axios.post('/location', { sessionID, x: longitude, y: latitude }); // 세션 ID로 위치 저장 요청 보내기\r\n                setIsLocationSaved(true); // 위치 저장됨을 표시\r\n                // alert('위치가 성공적으로 저장되었습니다.');\r\n            });\r\n        } catch (error) {\r\n            console.error('위치 저장 중 오류가 발생했습니다:', error);\r\n            // alert('위치를 저장하는 도중 오류가 발생했습니다.');\r\n        }\r\n    };\r\n\r\n    const LoginSuccess = async (data: LoginForm) => {\r\n        try {\r\n            const response = await axios.post('/login', data);\r\n            // console.log('로그인 응답 데이터:', response.data); // 로그인 응답 데이터 확인\r\n            const { sessionID, userId } = response.data; // 세션 ID 및 사용자 이름 받아오기\r\n            if (response.data.message === '로그인 성공' && sessionID) {\r\n                setSessionID(sessionID); // 세션 ID 설정\r\n                setUserId(userId); // 사용자 아이디 설정\r\n                sessionStorage.setItem('sessionID', sessionID); // 세션 스토리지에 세션 ID 저장\r\n                sessionStorage.setItem('userId', userId); // 세션 스토리지에 사용자 아이디 저장\r\n                // 위치 저장 요청 보내기\r\n                // saveLocation(sessionID); // 세션 ID를 인자로 사용하여 위치 저장 요청 보내기\r\n                alert(\"로그인에 성공했습니다.\");\r\n                setLogin(false);\r\n            } else {\r\n                console.error('로그인 실패:', response.data.message);\r\n            }\r\n        } catch (error) {\r\n            console.error('로그인 중 오류가 발생했습니다:', error);\r\n        }\r\n    };\r\n\r\n    const handleLogout = async () => {\r\n        try {\r\n            await axios.get('/logout'); // 서버로 로그아웃 요청 보냄\r\n            sessionStorage.removeItem('sessionID'); // 세션 스토리지에서 세션 ID 제거\r\n            setSessionID(''); // 세션 ID 초기화\r\n            setUserId('');\r\n            navigate('/'); // 홈 페이지로 이동\r\n        } catch (error) {\r\n            console.error('로그아웃 중 오류가 발생했습니다:', error);\r\n        }\r\n    };\r\n    return (\r\n        <div>\r\n            <LoginContainer className=\"card\"\r\n                variants={boxVariants}\r\n                initial=\"initial\"\r\n                animate=\"visible\"\r\n                exit=\"leaving\"\r\n            >\r\n                <form onSubmit={handleSubmit(LoginSuccess)}>\r\n                    <div className=\"card-header\">\r\n                        로그인\r\n                    </div>\r\n                    <ul className=\"list-group list-group-flush\">\r\n                        <LoginList className=\"list-group-item\"><LoginInput {...register(\"id\")} placeholder=\"아이디를 입력하세요\" /></LoginList>\r\n                        <LoginList className=\"list-group-item\"><LoginInput {...register(\"password\")} placeholder=\"비밀번호를 입력하세요\" /></LoginList>\r\n                        <LoginBtn type=\"submit\">로그인</LoginBtn>\r\n                    </ul>\r\n                </form>\r\n            </LoginContainer>\r\n            <Overlay />\r\n        </div>\r\n    )\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}